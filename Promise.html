<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    1111
    <script>
        //  var p1 = new Promise((resolve,reject)=>{
        //      resolve('成功')
        //     // reject('失败')
        //  })
        //  p1.then((res)=>{
        //      console.log(res)
        //  },(reason)=>{
        //      console.log(reason)
        //  })
        //  Promise 有三个状态 pending fulfilled rejected 状态一旦改变就不可变，接受一个函数作为参数
        //  实例的then方法接受两个参数 promise.then(onFullfilled,onRejected)
        //  第一版
        function MyPromise( constructor ){
           var _this = this;
           _this.status = 'pending'; // 初始状态
           _this.value =  undefined ; // 定义状态为resolved 的时候的值
           _this.reason = undefined ; // 定义状态为rejected 的时候的值 
           function resolve(value){
              if(_this.status == 'pending'){
                  _this.value = value;
                  _this.status = 'resolved'
              }
           }
           function reject(reason){
              if(_this.status == 'pending'){
                  _this.reason = reason;
                  _this.status = 'rejected'
              }
           }
           constructor(resolve,reject)
        }
        MyPromise.prototype.then = function( onFullfilled,onRejected ){
            var _this = this;
            console.log(_this.status)
            switch( _this.status ){
                case 'resolved':
                onFullfilled(_this.value);
                break;
                case 'rejected':
                onRejected(_this.reason);
                break;
                default:
                break;
            }
        }
        // var p2 = new MyPromise((resolve,reject)=>{
        //     resolve('MyPromise')
        // })
        // p2.then((res)=>{
        //     console.log(res)
        // })
        // var p4 = new Promise((resolve,reject)=>{
        //     setTimeout(()=>{resolve(2000)},0)
        // })
        // p4.then((res)=>{
        //     console.log(res)
        // })
        var p3 = new MyPromise((resolve,reject)=>{
            setTimeout(()=>{resolve(1000)},2000)
        })
        setTimeout(()=>{
            p3.then((res)=>{
              console.log(res)
            })
        },1000)

    </script>
</html>